<section class="seccion-perfil-usuario">
  <div class="perfil-usuario-header">
      <div class="perfil-usuario-portada">
          <img src="../../../assets/electricoss.webp" alt="img-avatar">
          <div class="perfil-usuario-avatar">
              <img [src]="'data:image/jpeg;base64,' + workerData.image" alt="Imagen de Posting" class="card-img">
              <button type="button" class="boton-avatar">
                <i class="far fa-image"></i>
              </button>
            </div>
            
                      
          <button type="button" class="boton-portada">
              <i class="far fa-image"></i> Cambiar fondo
          </button>
      </div>
  </div>
  <div class="perfil-usuario-body">
      <div class="perfil-usuario-bio">
        
          <h3 class="titulo">{{workerData.first_name}}  {{workerData.last_name}}</h3>
          <p class="texto"> {{workerData.profile_description}}</p>

          <div class="estrellas-rating">
            <div class="calificacion-numerica">{{ rating | number: '1.1-1' }}</div>
            <div class="estrellas">
              <span *ngFor="let star of stars; let i = index" 
                    class="estrella"
                    (click)="rate(i + 1)"
                    [ngClass]="{'filled': rating >= i + 1, 'half-filled': rating > i && rating < i + 1}">
                &#9733;
              </span>
            </div>
          </div>
          
      </div>
      <div class="perfil-usuario-footer">
          <ul class="lista-datos">
              <li><i class="icono fas fa-map-signs"></i> Rut: {{workerData.rut}}</li>
              <li><i class="icono fas fa-phone-alt"></i> Telefono: {{workerData.contact_number}}</li>
              <li><i class="icono fas fa-briefcase"></i> Especialidad: {{workerData.specialty}}</li>
          </ul>
          
          <ul class="lista-datos">
              <li><i class="icono fas fa-map-marker-alt"></i> Comuna: {{workerData.location}}</li>
              <li><i class="icono fas fa-calendar-alt"></i> Cuenta creada el: {{workerData.created_date | date: 'dd/MM/yyyy'}}</li>
              <li><i class="icono fas fa-inbox"></i> Email: {{workerData.email}}</li>
          </ul>

      </div>

      <div class="redes-sociales">
          <a href="https://www.facebook.com/" class="boton-redes facebook fab fa-facebook-f"><i class="icon-facebook"></i></a>
          <a [href]="'https://wa.me/+56' +  workerData.contact_number" class="boton-redes whatsapp fab fa-whatsapp"><i class="icon-whatsapp"></i></a>
          <a href="https://www.instagram.com/" class="boton-redes instagram fab fa-instagram"><i class="icon-instagram"></i></a>
      </div>
  </div>
</section>

<section class="fcrearpublicacion">
  <!-- Modal para crear una nueva publicación -->
  <form (ngSubmit)="crearPublicacion()" #publicacionForm="ngForm">
    <div class="form-group">
      <label>Seleccione especialidad</label>
      <select [(ngModel)]="nuevaPublicacion.job_types" name="job_types" required class="form-control">
        <option value="Electricista">Electricista</option>
        <option value="Zapatero">Zapatero</option>
        <option value="Albañil">Albañil</option>
      </select>
    </div>

    <div class="form-group">
      <label for="description">Descripción:</label>
      <textarea id="description" name="description" [(ngModel)]="nuevaPublicacion.description" required class="form-control"></textarea>
    </div>

    <div class="form-group">
      <label for="file">Archivos:</label>
      <input type="file" id="file" name="file" (change)="onFileSelected($event)" multiple class="form-control">
      <div *ngFor="let file of files; let i = index" class="file-list">
        <span>{{ file.name }}</span>
        <button type="button" (click)="eliminarArchivo(i)">Eliminar</button>
      </div>
    </div>

    <div class="crear-publicacion">
      <button type="submit" [disabled]="!publicacionForm.valid" class="boton-crear-publicacion">
        <i class="fas fa-edit">Crear Publicación</i>
      </button>
    </div>
  </form>

  <div class="publicaciones">
    <div *ngFor="let publicacion of publicaciones" class="publicacion">
      <p>{{ publicacion.texto }}</p>
      <div class="media">
        <ng-container *ngFor="let file of publicacion.files">
          <img *ngIf="file.type.includes('image')" [src]="file.url" [alt]="file.name">
          <video *ngIf="file.type.includes('video')" [src]="file.url" controls></video>
        </ng-container>
      </div>
    </div>
  </div>
</section>